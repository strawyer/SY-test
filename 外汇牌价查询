from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import sys
import time

# 输入参数：日期和货币代号
date, currency_code = sys.argv[1], sys.argv[2]

# 启动webdriver
driver = webdriver.Chrome()

# 打开中国银行外汇牌价网站
driver.get('https://www.boc.cn/sourcedb/whpj/')

# 等待页面加载完成
WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.ID, 'publish')))

# 获取表格中的所有行
rows = driver.find_elements_by_xpath('//table[@class="publish"]/tbody/tr')

# 遍历每一行，查找匹配的日期和货币代号
for row in rows:
    cells = row.find_elements_by_tag_name('td')
    if cells[0].text == date and cells[1].text == currency_code:
        # 找到匹配的行，打印现汇卖出价
        print(cells[5].text)
        break

# 关闭webdriver
driver.quit()
